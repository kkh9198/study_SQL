--1
SELECT A.EMPLOYEE_ID,A.FIRST_NAME ||' ' ||A.LAST_NAME EMP_NAME,
A.JOB_ID,A.SALARY,
(SELECT AVG(B.SALARY)
FROM EMPLOYEES B
WHERE A.JOB_ID =B.JOB_ID
GROUP BY B.JOB_ID)AVG_SALARY
FROM EMPLOYEES A;
--해당 EMPLOYEE ID 의  SALARY와 JOB_ID별 평균 SALARY
--2
SELECT B.DEPARTMENT_NAME, LOC.STREET_ADDRESS, LOC.COUNTRY_NAME
FROM DEPARTMENTS B,
LATERAL(SELECT L.LOCATION_ID, L.STREET_ADDRESS, C.COUNTRY_NAME 
FROM LOCATIONS L, COUNTRIES C
WHERE L.COUNTRY_ID=C.COUNTRY_ID)LOC
WHERE B.LOCATION_ID =LOC.LOCATION_ID;
--3
SELECT EMPLOYEE_ID,
JOB_ID,SALARY
FROM EMPLOYEES A
WHERE EXISTS (SELECT 1 FROM JOBS B WHERE A.JOB_ID=B.JOB_ID AND A.SALARY=B.MIN_SALARY);

SELECT EMPLOYEE_ID,JOB_ID,SALARY
FROM EMPLOYEES
WHERE (JOB_ID,SALARY) IN (SELECT JOB_ID,MIN_SALARY
FROM JOBS);

--4
SELECT DEPARTMENT_ID FROM EMPLOYEES;
SELECT *
FROM DEPARTMENTS
WHERE DEPARTMENT_ID NOT IN(
SELECT A.DEPARTMENT_ID
FROM EMPLOYEES A 
WHERE A.DEPARTMENT_ID IS NOT NULL);
