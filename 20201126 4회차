--1
SELECT COUNTRY_ID, COUNT(*)
FROM LOCATIONS
GROUP BY COUNTRY_ID;
--2
SELECT TO_CHAR(TO_DATE(HIRE_DATE,'YYYY-MM-DD HH24:MI;SS'),'Q' )  ,COUNT(*)
FROM EMPLOYEES
GROUP BY TO_CHAR(TO_DATE(HIRE_DATE,'YYYY-MM-DD HH24:MI;SS'),'Q')
ORDER BY 1;
select to_char(hire_date,'Q'),count(*)
from employees
group by to_char(hire_date,'Q')
order by 1;
--3
SELECT JOB_ID, ROUND(AVG(SALARY),0) AVG_SALARY, ROUND(SUM(SALARY)/COUNT(*),0) AVG_SALARY1
FROM EMPLOYEES
GROUP BY JOB_ID
ORDER BY 1;
--4
SELECT TO_CHAR(TO_DATE(DATES,'YYYY-MM-DD HH24:MI:SS'),'MM'),SUM(NEW_CASES)
FROM COVID19
WHERE ISO_CODE ='KOR'
GROUP BY TO_CHAR(TO_DATE(DATES,'YYYY-MM-DD HH24:MI:SS'),'MM')
ORDER BY 1;
select to_char(dates, 'MM'),sum(new_cases)
from covid19
where iso_code = 'KOR'
group by to_char(dates, 'MM')
order by 1;
--5
SELECT TO_CHAR(TO_DATE(DATES,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM') AS MONTHS,SUM(NEW_CASES) AS 확진자수, SUM(NEW_DEATHS) AS 사망자수,
CASE SUM(NEW_CASES) WHEN 0 THEN 0
    ELSE ROUND(SUM(NEW_DEATHS)/SUM(NEW_CASES)*100,2) 
    END AS 사망률
FROM COVID19
WHERE ISO_CODE = 'KOR'
GROUP BY TO_CHAR(TO_DATE(DATES,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM')
ORDER BY 1;
--6
SELECT *
FROM(
SELECT COUNTRY, NVL(SUM(NEW_CASES),0) 
FROM COVID19
WHERE TO_CHAR(TO_DATE(DATES,'YYYY-MM-DD HH24:MI:SS'),'YYYY-MM') = '2020-10' AND COUNTRY  <> 'World' 
GROUP BY COUNTRY 
ORDER BY 2 DESC
)
WHERE ROWNUM<=5;

--1
SELECT JOB_ID JOBS
FROM EMPLOYEES
WHERE DEPARTMENT_ID=60
UNION
SELECT JOB_ID 
FROM EMPLOYEES
WHERE DEPARTMENT_ID=90
ORDER BY JOB_ID;--첫 SELECT문에서 컬럼명을 지정했기 때문에 ORDER BY 절에는 지정한 컬럼명을 적어야한다. 
--2
SELECT * FROM EMPLOYEES;
SELECT EMPLOYEE_ID, HIRE_DATE
FROM EMPLOYEES
WHERE TO_CHAR(TO_DATE(HIRE_DATE,'YYYY-MM-DD HH24:MI:SS'),'YYYY')=2001
UNION 
SELECT EMPLOYEE_ID, HIRE_DATE
FROM EMPLOYEES
WHERE TO_CHAR(TO_DATE(HIRE_DATE,'YYYY-MM-DD HH24:MI:SS'),'YYYY')=2003;
--3
SELECT * FROM EMPLOYEES;
SELECT JOB_ID,SUM(SALARY)
FROM EMPLOYEES
GROUP BY JOB_ID
UNION
SELECT 'TOTAL SALARY' JOB_ID, SUM(SALARY)
FROM EMPLOYEES
ORDER BY 1;
--4
SELECT COUNTRY
FROM COVID19
WHERE DATES BETWEEN TO_DATE('20200101','YYYYMMDD') AND TO_DATE('20200630','YYYYMMDD')
GROUP BY TO_CHAR(DATES,'YYYY-MM'),COUNTRY
HAVING NVL(SUM(NEW_CASES),0)>=10000
INTERSECT
SELECT COUNTRY
FROM COVID19
WHERE DATES BETWEEN TO_DATE('20200701','YYYYMMDD') AND TO_DATE('20201031','YYYYMMDD')
GROUP BY TO_CHAR(DATES,'YYYY-MM'),COUNTRY
HAVING NVL(SUM(NEW_CASES),0)<=1000;
